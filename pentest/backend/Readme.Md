# API Penetration Tester

An API penetration testing tool that automatically tests web APIs for common security vulnerabilities.

## Security Tests Included

| ID | Name | Severity | Description |
|----|------|----------|-------------|
| AUTH_MISSING | Missing Authentication | HIGH | Tests if endpoints can be accessed without authentication |
| SQL_INJECTION | SQL Injection | HIGH | Tests for SQL injection vulnerabilities |
| NOSQL_INJECTION | NoSQL Injection | HIGH | Tests for NoSQL/MongoDB injection vulnerabilities |
| RATE_LIMITING | Rate Limiting | MEDIUM | Checks if API has rate limiting protection |
| SECURITY_HEADERS | Security Headers | MEDIUM | Checks for missing security headers |
| SENSITIVE_DATA_EXPOSURE | Sensitive Data Exposure | HIGH | Checks for data leakage in responses |

## Setup

```bash
# Install dependencies
npm install

# Start the penetration tester server
node server.js
```

The server will start on port 3000.

## Testing with the Vulnerable Target

A vulnerable test API is included for testing purposes:

```bash
# Terminal 1: Start the penetration tester
node server.js

# Terminal 2: Start the vulnerable target API
node test-target.js
```

The test target runs on port 4000.

## API Endpoints

### Health Check
```
GET /health
```

### List Available Tests
```
GET /tests
```

### Run All Security Tests

```
curl -X POST http://localhost:3000/scan -H "Content-Type: application/json" -d "{\"targetUrl\": \"http://localhost:4000/api/users\"}"
```

### Run Specific Test
```
curl -X POST http://localhost:3000/scan -H "Content-Type: application/json" -d "{\"targetUrl\": \"http://localhost:4000/api/user\"}"
```

## Example Response

```json
{
  "success": true,
  "targetUrl": "http://localhost:4000/api/users",
  "scannedAt": "2026-01-08T10:30:00.000Z",
  "summary": {
    "totalTests": 6,
    "passed": 1,
    "failed": 4,
    "warnings": 1,
    "errors": 0
  },
  "results": [
    {
      "id": "AUTH_MISSING",
      "name": "Missing Authentication",
      "status": "WARNING",
      "severity": "HIGH",
      "findings": [...],
      "details": "..."
    }
  ]
}
```

## Project Structure

```
api-penetration-tester/
├── server.js         # Express server with API endpoints
├── tester.js         # Core penetration testing logic
├── package.json      # Dependencies and scripts
├── test-target.js    # Vulnerable API for testing
└── README.md         # This file
```

## Test Status Meanings

| Status | Meaning |
|--------|---------|
| PASS | No vulnerability detected |
| FAIL | Vulnerability detected |
| WARNING | Potential issue, needs review |
| ERROR | Test could not complete |